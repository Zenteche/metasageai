(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3591],{39546:(e,t,s)=>{Promise.resolve().then(s.bind(s,43581))},43581:(e,t,s)=>{"use strict";s.d(t,{default:()=>V});var n=s(95155),r=s(75828);let i=(0,r.createServerReference)("7089d992d34b939b0ee04c3f287b8aab9728d9416c",r.callServer,void 0,r.findSourceMapURL,"createMessage");function l(e){return(0,n.jsxs)("svg",{width:20,height:20,viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e,children:[(0,n.jsx)("rect",{x:.25,y:.25,width:19.5,height:19.5,rx:1.75,fill:"url(#paint0_linear_611_2729)",stroke:"url(#paint1_linear_611_2729)",strokeWidth:.5}),(0,n.jsx)("g",{style:{mixBlendMode:"overlay"},filter:"url(#filter0_f_611_2729)",children:(0,n.jsx)("path",{d:"M13.584 8.16h4.923",stroke:"#D9D9D9",strokeWidth:.3})}),(0,n.jsx)("g",{style:{mixBlendMode:"overlay"},filter:"url(#filter1_f_611_2729)",children:(0,n.jsx)("path",{d:"M13.143 13.279h4.922",stroke:"#D9D9D9",strokeWidth:.3})}),(0,n.jsx)("g",{style:{mixBlendMode:"overlay"},filter:"url(#filter2_f_611_2729)",children:(0,n.jsx)("path",{d:"M14.43 12.32h2.597",stroke:"#D9D9D9",strokeWidth:.3})}),(0,n.jsx)("g",{style:{mixBlendMode:"overlay"},filter:"url(#filter3_f_611_2729)",children:(0,n.jsx)("path",{d:"M5.582 8.85h2.596",stroke:"#D9D9D9",strokeWidth:.3})}),(0,n.jsx)("g",{style:{mixBlendMode:"overlay"},filter:"url(#filter4_f_611_2729)",children:(0,n.jsx)("path",{d:"M4.546 10.565h1.756",stroke:"#D9D9D9",strokeWidth:.3})}),(0,n.jsx)("path",{d:"M12.916 13.426l2.917-3.01-2.917-3.008m-5.833 0l-2.917 3.009 2.917 3.01M11.166 5L8.833 15.834",stroke:"#fff",strokeWidth:1.3,strokeLinecap:"round",strokeLinejoin:"round"}),(0,n.jsxs)("defs",{children:[(0,n.jsxs)("filter",{id:"filter0_f_611_2729",x:12.584,y:7.0105,width:6.92285,height:2.2998,filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB",children:[(0,n.jsx)("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),(0,n.jsx)("feBlend",{in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}),(0,n.jsx)("feGaussianBlur",{stdDeviation:.5,result:"effect1_foregroundBlur_611_2729"})]}),(0,n.jsxs)("filter",{id:"filter1_f_611_2729",x:12.1426,y:12.1289,width:6.92285,height:2.2998,filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB",children:[(0,n.jsx)("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),(0,n.jsx)("feBlend",{in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}),(0,n.jsx)("feGaussianBlur",{stdDeviation:.5,result:"effect1_foregroundBlur_611_2729"})]}),(0,n.jsxs)("filter",{id:"filter2_f_611_2729",x:13.4307,y:11.1694,width:4.59619,height:2.2998,filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB",children:[(0,n.jsx)("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),(0,n.jsx)("feBlend",{in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}),(0,n.jsx)("feGaussianBlur",{stdDeviation:.5,result:"effect1_foregroundBlur_611_2729"})]}),(0,n.jsxs)("filter",{id:"filter3_f_611_2729",x:4.58154,y:7.70068,width:4.59619,height:2.2998,filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB",children:[(0,n.jsx)("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),(0,n.jsx)("feBlend",{in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}),(0,n.jsx)("feGaussianBlur",{stdDeviation:.5,result:"effect1_foregroundBlur_611_2729"})]}),(0,n.jsxs)("filter",{id:"filter4_f_611_2729",x:3.5459,y:9.41528,width:3.75586,height:2.2998,filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB",children:[(0,n.jsx)("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),(0,n.jsx)("feBlend",{in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}),(0,n.jsx)("feGaussianBlur",{stdDeviation:.5,result:"effect1_foregroundBlur_611_2729"})]}),(0,n.jsxs)("linearGradient",{id:"paint0_linear_611_2729",x1:10,y1:0,x2:10,y2:20,gradientUnits:"userSpaceOnUse",children:[(0,n.jsx)("stop",{stopColor:"#326DF5"}),(0,n.jsx)("stop",{offset:1,stopColor:"#1D264A"})]}),(0,n.jsxs)("linearGradient",{id:"paint1_linear_611_2729",x1:10,y1:20,x2:10,y2:0,gradientUnits:"userSpaceOnUse",children:[(0,n.jsx)("stop",{stopColor:"#326DF5"}),(0,n.jsx)("stop",{offset:1,stopColor:"#1D264A"})]})]})]})}var a=s(29602),o=s(48173),d=s.n(o),c=s(76046),u=s(12115),f=s(17612),x=s(19037),h=s(87159);function m(e){let{chat:t,onNewStreamPromise:s,isStreaming:r}=e,[l,a]=(0,u.useTransition)(),o=(0,c.useRouter)(),d=l||r,f=(0,u.useRef)(!1),m=(0,u.useRef)(null),[g,p]=(0,u.useState)(""),j=g.split("\n").map(e=>""===e?"a":e).join("\n");return(0,u.useEffect)(()=>{m.current&&(d||f.current?f.current=!1:(m.current.focus(),f.current=!0))},[d]),(0,n.jsx)("div",{className:"mx-auto mb-5 flex w-full max-w-prose shrink-0 px-8",children:(0,n.jsx)("form",{className:"relative flex w-full",action:async()=>{a(async()=>{s(fetch("/api/get-next-completion-stream-promise",{method:"POST",body:JSON.stringify({messageId:(await i(t.id,g,"user")).id,model:t.model})}).then(e=>{if(!e.body)throw Error("No body on response");return e.body})),a(()=>{o.refresh(),p("")})})},children:(0,n.jsx)("fieldset",{className:"w-full",disabled:d,children:(0,n.jsxs)("div",{className:"relative flex rounded-lg border-4 border-gray-300 bg-white",children:[(0,n.jsxs)("div",{className:"relative w-full",children:[(0,n.jsx)("div",{className:"w-full p-2",children:(0,n.jsx)("p",{className:"invisible min-h-[48px] w-full whitespace-pre-wrap",children:j})}),(0,n.jsx)("textarea",{ref:m,placeholder:"Follow up",autoFocus:!d,value:g,onChange:e=>p(e.target.value),required:!0,name:"prompt",className:"peer absolute inset-0 w-full resize-none bg-transparent p-2 placeholder-gray-500 focus:outline-none disabled:opacity-50",onKeyDown:e=>{if("Enter"===e.key&&!e.shiftKey){var t;e.preventDefault();let s=e.target;s instanceof HTMLTextAreaElement&&(null===(t=s.closest("form"))||void 0===t||t.requestSubmit())}}})]}),(0,n.jsx)("div",{className:"pointer-events-none absolute inset-0 rounded peer-focus:outline peer-focus:outline-offset-0 peer-focus:outline-blue-500"}),(0,n.jsxs)("div",{className:"absolute bottom-1.5 right-1.5 flex has-[:disabled]:opacity-50",children:[(0,n.jsx)("div",{className:"pointer-events-none absolute inset-0 -bottom-[1px] rounded bg-blue-700"}),(0,n.jsx)("button",{className:"relative inline-flex size-6 items-center justify-center rounded bg-blue-500 font-medium text-white shadow-lg outline-blue-300 hover:bg-blue-500/75 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",type:"submit",children:(0,n.jsx)(h.default,{loading:d,children:(0,n.jsx)(x.A,{})})})]})]})})})})}function g(e){return(0,n.jsx)("svg",{width:12,height:12,viewBox:"0 0 12 12",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e,children:(0,n.jsx)("path",{d:"M.75.75v10.5M6.583 2.5L3.083 6m0 0l3.5 3.5M3.083 6h8.167",stroke:"#525252",strokeLinecap:"round",strokeLinejoin:"round"})})}var p=s(11226),j=s(10985);function v(e){let{chat:t,activeMessage:s,streamText:r,onMessageClick:i}=e,l=t.messages.filter(e=>"assistant"===e.role);return(0,n.jsx)(j.z,{className:"relative grow overflow-hidden",resize:"smooth",initial:"smooth",children:(0,n.jsxs)(j.z.Content,{className:"mx-auto flex w-full max-w-prose flex-col gap-8 p-8",children:[(0,n.jsx)(b,{content:t.prompt}),t.messages.slice(2).map(e=>(0,n.jsx)(u.Fragment,{children:"user"===e.role?(0,n.jsx)(b,{content:e.content}):(0,n.jsx)(y,{content:e.content,version:l.map(e=>e.id).indexOf(e.id)+1,message:e,isActive:!r&&(null==s?void 0:s.id)===e.id,onMessageClick:i})},e.id)),r&&(0,n.jsx)(y,{content:r,version:l.length+1,isActive:!0})]})})}function b(e){let{content:t}=e;return(0,n.jsx)("div",{className:"relative inline-flex max-w-[80%] items-end gap-3 self-end",children:(0,n.jsx)("div",{className:"whitespace-pre-wrap rounded bg-white px-4 py-2 text-gray-600 shadow",children:t})})}function y(e){let{content:t,version:s,message:r,isActive:i,onMessageClick:l=()=>{}}=e,o=(0,a.k)(t);return(0,n.jsx)("div",{children:o.map((e,t)=>(0,n.jsx)("div",{children:"text"===e.type?(0,n.jsx)(p.o,{className:"prose",children:e.content}):"first-code-fence-generating"===e.type?(0,n.jsx)("div",{className:"my-4",children:(0,n.jsxs)("button",{disabled:!0,className:"inline-flex w-full animate-pulse items-center gap-2 rounded-lg border-4 border-gray-300 p-1.5",children:[(0,n.jsxs)("div",{className:"flex size-8 items-center justify-center rounded bg-gray-300 font-bold",children:["V",s]}),(0,n.jsx)("div",{className:"flex flex-col gap-0.5 text-left leading-none",children:(0,n.jsx)("div",{className:"text-sm font-medium leading-none",children:"Generating..."})})]})}):r?(0,n.jsx)("div",{className:"my-4",children:(0,n.jsxs)("button",{className:"".concat(i?"bg-white":"bg-gray-300 hover:border-gray-400 hover:bg-gray-400"," inline-flex w-full items-center gap-2 rounded-lg border-4 border-gray-300 p-1.5"),onClick:()=>l(r),children:[(0,n.jsxs)("div",{className:"".concat(i?"bg-gray-300":"bg-gray-200"," flex size-8 items-center justify-center rounded font-bold"),children:["V",s]}),(0,n.jsxs)("div",{className:"flex flex-col gap-0.5 text-left leading-none",children:[(0,n.jsxs)("div",{className:"text-sm font-medium leading-none",children:[w(e.filename.name)," ",1!==s&&"v".concat(s)]}),(0,n.jsxs)("div",{className:"text-xs leading-none text-gray-500",children:[e.filename.name,1!==s&&"-v".concat(s),".",e.filename.extension]})]}),(0,n.jsx)("div",{className:"ml-auto",children:(0,n.jsx)(g,{})})]})}):(0,n.jsx)("div",{className:"my-4",children:(0,n.jsxs)("button",{className:"inline-flex w-full items-center gap-2 rounded-lg border-4 border-gray-300 p-1.5",disabled:!0,children:[(0,n.jsxs)("div",{className:"flex size-8 items-center justify-center rounded bg-gray-300 font-bold",children:["V",s]}),(0,n.jsxs)("div",{className:"flex flex-col gap-0.5 text-left leading-none",children:[(0,n.jsxs)("div",{className:"text-sm font-medium leading-none",children:[w(e.filename.name)," ",1!==s&&"v".concat(s)]}),(0,n.jsxs)("div",{className:"text-xs leading-none text-gray-500",children:[e.filename.name,1!==s&&"-v".concat(s),".",e.filename.extension]})]}),(0,n.jsx)("div",{className:"ml-auto",children:(0,n.jsx)(g,{})})]})})},t))})}function w(e){return e.split(/[-_]+/).map(e=>e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()).join(" ")}function N(e){return(0,n.jsx)("svg",{width:14,height:14,viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e,children:(0,n.jsx)("path",{d:"M8.75 10.5L5.25 7l3.5-3.5",stroke:"currentColor",strokeWidth:.6,strokeLinecap:"round",strokeLinejoin:"round"})})}function _(e){return(0,n.jsx)("svg",{width:14,height:14,viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e,children:(0,n.jsx)("path",{d:"M5.25 10.5L8.75 7l-3.5-3.5",stroke:"currentColor",strokeWidth:.6,strokeLinecap:"round",strokeLinejoin:"round"})})}function k(e){return(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"size-6",...e,children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})}function S(e){return(0,n.jsx)("svg",{width:10,height:11,viewBox:"0 0 10 11",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e,children:(0,n.jsx)("path",{d:"M9.226 5.947A4.25 4.25 0 011.32 7.626l-.125-.217m-.42-2.356A4.25 4.25 0 018.68 3.374l.124.217M.747 8.533l.366-1.366 1.366.366M7.52 3.467l1.366.366.366-1.366",stroke:"currentColor",strokeWidth:.7,strokeLinecap:"round",strokeLinejoin:"round"})})}function B(e){return(0,n.jsx)("svg",{width:10,height:11,viewBox:"0 0 10 11",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e,children:(0,n.jsx)("path",{d:"M9.5 2.5H7.9c-.84 0-1.26 0-1.581.163a1.5 1.5 0 00-.656.656c-.163.32-.163.74-.163 1.581v.6m4-3L8 1m1.5 1.5L8 4M4 1H2.9c-.84 0-1.26 0-1.581.163a1.5 1.5 0 00-.656.656C.5 2.139.5 2.559.5 3.4v4.2c0 .84 0 1.26.163 1.581a1.5 1.5 0 00.656.656c.32.163.74.163 1.581.163h4.2c.84 0 1.26 0 1.581-.163a1.5 1.5 0 00.656-.656c.163-.32.163-.74.163-1.581V6.5",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"})})}var D=s(20241);function M(e){let{message:t}=e;async function s(){if(!t)return;let e=window.location.href,s=new URL("/share/v2/".concat(t.id),e);(0,D.oR)({title:"App Published!",description:"App URL copied to clipboard: ".concat(s.href),variant:"default"}),await navigator.clipboard.writeText(s.href)}return(0,n.jsx)("form",{action:s,className:"flex",children:(0,n.jsxs)("button",{type:"submit",disabled:!t,className:"inline-flex items-center gap-1 rounded border border-gray-300 px-1.5 py-0.5 text-sm text-gray-600 enabled:hover:bg-white disabled:opacity-50",children:[(0,n.jsx)(B,{className:"size-3"}),"Share"]})})}var C=s(77711);let O=(0,C.default)(()=>Promise.all([s.e(6079),s.e(4767),s.e(751),s.e(854),s.e(7530)]).then(s.bind(s,87530)),{loadableGenerated:{webpack:()=>[87530]},ssr:!1}),T=(0,C.default)(()=>Promise.all([s.e(9163),s.e(5851)]).then(s.bind(s,85851)),{loadableGenerated:{webpack:()=>[85851]},ssr:!1});function F(e){var t;let{chat:s,streamText:r,message:i,onMessageChange:l,activeTab:o,onTabChange:d,onClose:c,onRequestFix:f}=e,x=i?(0,a.W)(i.content):void 0,h=(0,a.k)(r),m=h.find(e=>"first-code-fence-generating"===e.type||"first-code-fence"===e.type),g=h.some(e=>"first-code-fence-generating"===e.type),p=m?m.content:(null==x?void 0:x.code)||"",v=m?m.language:(null==x?void 0:x.language)||"",b=m?m.filename.name:(null==x?void 0:null===(t=x.filename)||void 0===t?void 0:t.name)||"",y=["python","ts","js","javascript","typescript"].includes(v)?"two-up":"tabbed",w=s.messages.filter(e=>"assistant"===e.role),B=m?w.length:i?w.map(e=>e.id).indexOf(i.id):1,D=0!==B?w.at(B-1):void 0,C=B<w.length?w.at(B+1):void 0,[F,A]=(0,u.useState)(0);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"flex h-16 shrink-0 items-center justify-between border-b border-gray-300 px-4",children:[(0,n.jsxs)("div",{className:"inline-flex items-center gap-4",children:[(0,n.jsx)("button",{className:"text-gray-400 hover:text-gray-700",onClick:c,children:(0,n.jsx)(k,{className:"size-5"})}),(0,n.jsxs)("span",{children:[b," v",B+1]})]}),"tabbed"===y&&(0,n.jsxs)("div",{className:"rounded-lg border-2 border-gray-300 p-1",children:[(0,n.jsx)("button",{onClick:()=>d("code"),"data-active":"code"===o||void 0,className:"inline-flex h-7 w-16 items-center justify-center rounded text-xs font-medium data-[active]:bg-blue-500 data-[active]:text-white",children:"Code"}),(0,n.jsx)("button",{onClick:()=>d("preview"),"data-active":"preview"===o||void 0,className:"inline-flex h-7 w-16 items-center justify-center rounded text-xs font-medium data-[active]:bg-blue-500 data-[active]:text-white",children:"Preview"})]})]}),"tabbed"===y?(0,n.jsx)("div",{className:"flex grow flex-col overflow-y-auto bg-white",children:"code"===o?(0,n.jsx)(j.z,{className:"relative grow overflow-hidden",resize:"smooth",initial:!!g&&"smooth",children:(0,n.jsx)(j.z.Content,{children:(0,n.jsx)(T,{code:p,language:v})})}):(0,n.jsx)(n.Fragment,{children:v&&(0,n.jsx)("div",{className:"flex h-full items-center justify-center",children:(0,n.jsx)(O,{onRequestFix:f,language:v,code:p},F)})})}):(0,n.jsxs)("div",{className:"flex grow flex-col bg-white",children:[(0,n.jsx)("div",{className:"h-1/2 overflow-y-auto",children:(0,n.jsx)(T,{code:p,language:v})}),(0,n.jsxs)("div",{className:"flex h-1/2 flex-col",children:[(0,n.jsx)("div",{className:"border-t border-gray-300 px-4 py-4",children:"Output"}),(0,n.jsx)("div",{className:"flex grow items-center justify-center border-t",children:!g&&(0,n.jsx)(O,{onRequestFix:f,language:v,code:p},F)})]})]}),(0,n.jsxs)("div",{className:"flex items-center justify-between border-t border-gray-300 px-4 py-4",children:[(0,n.jsxs)("div",{className:"inline-flex items-center gap-2.5 text-sm",children:[(0,n.jsx)(M,{message:i&&!m?i:void 0}),(0,n.jsxs)("button",{className:"inline-flex items-center gap-1 rounded border border-gray-300 px-1.5 py-0.5 text-sm text-gray-600 transition enabled:hover:bg-white disabled:opacity-50",onClick:()=>A(e=>e+1),children:[(0,n.jsx)(S,{className:"size-3"}),"Refresh"]})]}),(0,n.jsxs)("div",{className:"flex items-center justify-end gap-3",children:[D?(0,n.jsx)("button",{className:"text-gray-900",onClick:()=>l(D),children:(0,n.jsx)(N,{className:"size-4"})}):(0,n.jsx)("button",{className:"text-gray-900 opacity-25",disabled:!0,children:(0,n.jsx)(N,{className:"size-4"})}),(0,n.jsxs)("p",{className:"text-sm",children:["Version ",(0,n.jsx)("span",{className:"tabular-nums",children:B+1})," ",(0,n.jsx)("span",{className:"text-gray-400",children:"of"})," ",(0,n.jsx)("span",{className:"tabular-nums",children:Math.max(B+1,w.length)})]}),C?(0,n.jsx)("button",{className:"text-gray-900",onClick:()=>l(C),children:(0,n.jsx)(_,{className:"size-4"})}):(0,n.jsx)("button",{className:"text-gray-900 opacity-25",disabled:!0,children:(0,n.jsx)(_,{className:"size-4"})})]})]})]})}var A=s(52918);let L=e=>{let{shouldScaleBackground:t=!0,...s}=e;return(0,n.jsx)(A._s.Root,{shouldScaleBackground:t,...s})};L.displayName="Drawer",A._s.Trigger;let I=A._s.Portal;A._s.Close;let R=u.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,n.jsx)(A._s.Overlay,{ref:t,className:(0,a.cn)("fixed inset-0 z-50 bg-black/80",s),...r})});R.displayName=A._s.Overlay.displayName;let z=u.forwardRef((e,t)=>{let{className:s,children:r,...i}=e;return(0,n.jsxs)(I,{children:[(0,n.jsx)(R,{}),(0,n.jsxs)(A._s.Content,{ref:t,className:(0,a.cn)("fixed inset-x-0 bottom-0 z-50 mt-24 flex h-auto flex-col rounded-t-[10px] border bg-background",s),...i,children:[(0,n.jsx)("div",{className:"mx-auto mt-4 h-2 w-[100px] rounded-full bg-muted"}),r]})]})});z.displayName="DrawerContent";let E=u.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,n.jsx)(A._s.Title,{ref:t,className:(0,a.cn)("text-lg font-semibold leading-none tracking-tight",s),...r})});E.displayName=A._s.Title.displayName;let G=u.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,n.jsx)(A._s.Description,{ref:t,className:(0,a.cn)("text-sm text-muted-foreground",s),...r})});G.displayName=A._s.Description.displayName;var U=s(63543);function P(e){let{children:t,isShowing:s,onClose:r}=e,i=function(e){let[t,s]=(0,u.useState)(!1);return(0,u.useEffect)(()=>{function t(e){s(e.matches)}let n=matchMedia(e);return n.addEventListener("change",t),s(n.matches),()=>n.removeEventListener("change",t)},[e]),t}("(max-width: 1023px)");return(0,n.jsx)(n.Fragment,{children:i?(0,n.jsx)(L,{open:s,onClose:r,children:(0,n.jsxs)(z,{children:[(0,n.jsxs)(U.b,{children:[(0,n.jsx)(E,{children:"Code"}),(0,n.jsx)(G,{children:"Description"})]}),(0,n.jsx)("div",{className:"flex h-[90vh] flex-col overflow-y-scroll",children:t})]})}):(0,n.jsx)("div",{className:"".concat(s?"w-1/2":"w-0"," hidden h-full overflow-hidden py-5 transition-[width] lg:block"),children:(0,n.jsx)("div",{className:"ml-4 flex h-full flex-col rounded-l-xl shadow-lg shadow-gray-400/40",children:(0,n.jsx)("div",{className:"flex h-full flex-col rounded-l-xl shadow shadow-gray-800/50",children:t})})})})}var W=s(64638);function V(e){let{chat:t}=e,s=(0,u.use)(W.o),[r,o]=(0,u.useState)(s.streamPromise),[x,h]=(0,u.useState)(""),[g,p]=(0,u.useState)(t.messages.some(e=>"assistant"===e.role)),[j,b]=(0,u.useState)("preview"),y=(0,c.useRouter)(),w=(0,u.useRef)(!1),[N,_]=(0,u.useState)(t.messages.filter(e=>"assistant"===e.role).at(-1));return(0,u.useEffect)(()=>{(async function(){if(!r||w.current)return;w.current=!0,s.setStreamPromise(void 0);let e=await r,n=!1,l=!1;f.$.fromReadableStream(e).on("content",(e,t)=>{h(t=>t+e),!n&&(0,a.k)(t).some(e=>"first-code-fence-generating"===e.type)&&(n=!0,p(!0),b("code")),!l&&(0,a.k)(t).some(e=>"first-code-fence"===e.type)&&(l=!0,p(!0),b("preview"))}).on("finalContent",async e=>{(0,u.startTransition)(async()=>{let s=await i(t.id,e,"assistant");(0,u.startTransition)(()=>{w.current=!1,h(""),o(void 0),_(s),y.refresh()})})})})()},[t.id,y,r,s]),(0,n.jsx)("div",{className:"h-dvh",children:(0,n.jsxs)("div",{className:"flex h-full",children:[(0,n.jsxs)("div",{className:"mx-auto flex w-full shrink-0 flex-col overflow-hidden lg:w-1/2",children:[(0,n.jsxs)("div",{className:"flex items-center gap-4 px-4 py-4",children:[(0,n.jsx)(d(),{href:"/",children:(0,n.jsx)(l,{})}),(0,n.jsx)("p",{className:"italic text-gray-500",children:t.title})]}),(0,n.jsx)(v,{chat:t,streamText:x,activeMessage:N,onMessageClick:e=>{e!==N?(_(e),p(!0)):(_(void 0),p(!1))}}),(0,n.jsx)(m,{chat:t,onNewStreamPromise:o,isStreaming:!!r})]}),(0,n.jsx)(P,{isShowing:g,onClose:()=>{_(void 0),p(!1)},children:g&&(0,n.jsx)(F,{streamText:x,chat:t,message:N,onMessageChange:_,activeTab:j,onTabChange:b,onClose:()=>{_(void 0),p(!1)},onRequestFix:e=>{(0,u.startTransition)(async()=>{let s="The code is not working. Can you fix it? Here's the error:\n\n";s+=e.trimStart(),o(fetch("/api/get-next-completion-stream-promise",{method:"POST",body:JSON.stringify({messageId:(await i(t.id,s,"user")).id,model:t.model})}).then(e=>{if(!e.body)throw Error("No body on response");return e.body})),y.refresh()})}})})]})})}},64638:(e,t,s)=>{"use strict";s.d(t,{default:()=>l,o:()=>i});var n=s(95155),r=s(12115);let i=(0,r.createContext)({setStreamPromise:()=>{}});function l(e){let{children:t}=e,[s,l]=(0,r.useState)();return(0,n.jsx)(i,{value:{streamPromise:s,setStreamPromise:l},children:t})}},19037:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});var n=s(95155);function r(e){return(0,n.jsx)("svg",{width:12,height:6,viewBox:"0 0 12 6",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e,children:(0,n.jsx)("path",{d:"M1 2.519a.5.5 0 000 1v-1zm11 .5L7.003.13v5.777L12 3.02zm-11 .5h6.503v-1H1v1z",fill:"#fff"})})}},87159:(e,t,s)=>{"use strict";s.d(t,{default:()=>r});var n=s(95155);function r(e){let{loading:t=!0,children:s,className:r="size-3"}=e;if(!t)return s;let i=(0,n.jsx)(n.Fragment,{children:(0,n.jsx)("span",{className:"relative inline-flex ".concat(r),children:Array.from(Array(8).keys()).map(e=>(0,n.jsx)("span",{className:"before:bg-current absolute left-[calc(50%-12.5%/2)] top-0 h-[100%] w-[12.5%] animate-[spinner_800ms_linear_infinite] before:block before:h-[30%] before:w-[100%] before:rounded-full",style:{transform:"rotate(".concat(45*e,"deg)"),animationDelay:"calc(-".concat(8-e," / 8 * 800ms)")}},e))})});return s?(0,n.jsxs)("span",{className:"relative flex h-full items-center justify-center",children:[(0,n.jsx)("span",{className:"invisible flex",children:s}),(0,n.jsx)("span",{className:"absolute inset-0 flex items-center justify-center",children:i})]}):i}},20241:(e,t,s)=>{"use strict";s.d(t,{dj:()=>f,oR:()=>u});var n=s(12115);let r=0,i=new Map,l=e=>{if(i.has(e))return;let t=setTimeout(()=>{i.delete(e),c({type:"REMOVE_TOAST",toastId:e})},1e6);i.set(e,t)},a=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:s}=t;return s?l(s):e.toasts.forEach(e=>{l(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===s||void 0===s?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},o=[],d={toasts:[]};function c(e){d=a(d,e),o.forEach(e=>{e(d)})}function u(e){let{...t}=e,s=(r=(r+1)%Number.MAX_SAFE_INTEGER).toString(),n=()=>c({type:"DISMISS_TOAST",toastId:s});return c({type:"ADD_TOAST",toast:{...t,id:s,open:!0,onOpenChange:e=>{e||n()}}}),{id:s,dismiss:n,update:e=>c({type:"UPDATE_TOAST",toast:{...e,id:s}})}}function f(){let[e,t]=n.useState(d);return n.useEffect(()=>(o.push(t),()=>{let e=o.indexOf(t);e>-1&&o.splice(e,1)}),[e]),{...e,toast:u,dismiss:e=>c({type:"DISMISS_TOAST",toastId:e})}}},29602:(e,t,s)=>{"use strict";s.d(t,{W:()=>i,cn:()=>o,k:()=>a});var n=s(43463),r=s(69795);function i(e){let t=e.match(/```([^\n]*)\n([\s\S]*?)\n```/);if(t){let e=t[1]||"",s=t[2],n=t[0],r=null,i=null,a=e.match(/^([A-Za-z0-9]+)/);a&&(r=a[1]);let o=e.match(/{\s*filename\s*=\s*([^}]+)\s*}/);return o&&(i=l(o[1])),{code:s,language:r,filename:i,fullMatch:n}}return null}function l(e){let t=e.lastIndexOf(".");return -1===t?{name:e,extension:""}:{name:e.slice(0,t),extension:e.slice(t+1)}}function a(e){let t=[],s=e.split("\n"),n=!1,r=!1,i=[],a=[],o="",d=null,c=/^```([^\n]*)$/;for(let e of s){let s=e.match(c);if(r)i.push(e);else if(s&&!n){n=!0;let e=(o=s[1]||"").match(/{\s*filename\s*=\s*([^}]+)\s*}/);d=e?e[1]:null,i.length>0&&(t.push({type:"text",content:i.join("\n"),filename:{name:"",extension:""},language:""}),i=[])}else if(s&&n){n=!1,r=!0;let e=d?l(d):{name:"",extension:""},s=o.indexOf("{"),i=s>-1?o.substring(0,s).trim():o.trim();t.push({type:"first-code-fence",content:a.join("\n"),filename:e,language:i}),a=[]}else n?a.push(e):i.push(e)}if(n){let e=d?l(d):{name:"",extension:""},s=o.indexOf("{"),n=s>-1?o.substring(0,s).trim():o.trim();t.push({type:"first-code-fence-generating",content:a.join("\n"),filename:e,language:n})}else i.length>0&&t.push({type:"text",content:i.join("\n"),filename:{name:"",extension:""},language:""});return t}function o(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,r.QP)((0,n.$)(t))}}},e=>{var t=t=>e(e.s=t);e.O(0,[8173,1690,9396,5184,4196,8441,1517,7358],()=>t(39546)),_N_E=e.O()}]);